@using MVCSampleBrowser.Controllers
@section SampleHeading{<span class="sampleName">Grid-Cell Merging-ASP.NET MVC-SYNCFUSION</span>}
@section MetaTags{
    <meta name="description" content="This demo explains how to merge two or more cells of datagrid columns based on the required condition in Syncfusion ASP.NET MVC DataGrid control.">
}
@section ControlsSection{
    @(Html.EJ().Grid<Merge>("CellMerging")
        .Datasource((IEnumerable<object>)ViewBag.datasource)
        .AllowScrolling()
		.EnableRowHover(false)
		.AllowSelection(false)
        .ScrollSettings(scroll => { scroll.Height(400).Width(980); })
		.AllowTextWrap()
		.AllowCellMerging()
        .Columns(col =>
        {
            col.Field("EmployeeID").HeaderText("Employee ID").IsPrimaryKey(true).TextAlign(TextAlign.Right).Width(80).Add();
            col.Field("EmployeeName").HeaderText("Employee Name").Width(90).Add();
            col.Field("Time900").HeaderText("9.00 AM").Width(60).Add();
            col.Field("Time930").HeaderText("9.30 AM").Width(60).Add();
            col.Field("Time1000").HeaderText("10.00 AM").Width(60).Add();
            col.Field("Time1030").HeaderText("10.30 AM").Width(60).Add();
            col.Field("Time1100").HeaderText("11.00 AM").Width(60).Add();
            col.Field("Time1130").HeaderText("11.30 AM").Width(60).Add();
            col.Field("Time1200").HeaderText("12.00 PM").Width(60).Add();
            col.Field("Time1230").HeaderText("12.30 PM").Width(60).Add();
            col.Field("Time100").HeaderText("1.00 PM").Width(60).TextAlign(TextAlign.Center).Add();
            col.Field("Time130").HeaderText("1.30 PM").Width(60).Add();
            col.Field("Time200").HeaderText("2.00 PM").Width(60).Add();
            col.Field("Time230").HeaderText("2.30 PM").Width(60).Add();
            col.Field("Time300").HeaderText("3.00 PM").Width(60).Add();
            col.Field("Time330").HeaderText("3.30 PM").Width(40).Add();
            col.Field("Time400").HeaderText("4.00 PM").Width(60).Add();
            col.Field("Time430").HeaderText("4.30 PM").Width(60).Add();
            col.Field("Time500").HeaderText("5.00 PM").Width(60).Add();
        })
			.ClientSideEvents(eve => { eve.MergeCellInfo("cellmerge"); })
        )
	
}
@section ScriptSection{
    <script type="text/javascript">
        $(function () {
            var gridObj = $("#CellMerging").ejGrid("instance");
            scrolWidth = gridObj.model.scrollSettings.width / $(".cols-sample-area").width();
            if (gridObj.element.width() > $(".cols-sample-area").width()) {
                var scrollerwidth = Math.floor($(".cols-sample-area").width())
                gridObj.option("model.scrollSettings", { width: scrollerwidth })
                scrolWidth = 1;
            }
        });
        $(window).resize(function () {
            var gridObj = $("#CellMerging").ejGrid("instance")
            var scrollerwidth = Math.floor($(".cols-sample-area").width() * scrolWidth)
            gridObj.option("model.scrollSettings", { width: scrollerwidth })
        });
    </script>
}

	<script type="text/javascript">
			function cellmerge(args) {
			    if (args.data.EmployeeID == 10001) {
			        if (args.column.field == "Time900")
			            args.colMerge(2);
			        else if (args.column.field == "Time1100")
			            args.colMerge(3);
			        else if (args.column.field == "Time100")
			            args.merge(3, 10);
			        else if (args.column.field == "Time230")
			            args.colMerge(2);
			        else if (args.column.field == "Time430")
			            args.merge(2, 2);
			    }
			    else if (args.data.EmployeeID == 10002) {
			        if (args.column.field == "Time930")
			            args.colMerge(3);
			        else if (args.column.field == "Time1100")
			            args.colMerge(4);
			        else if (args.column.field == "Time230")
			            args.merge(2, 5);
			        else if (args.column.field == "Time330")
			            args.colMerge(2);
			    }
			    else if (args.data.EmployeeID == 10003) {
			        if (args.column.field == "Time900")
			            args.merge(3, 2);
			        else if (args.column.field == "Time1030")
			            args.colMerge(2);
			        else if (args.column.field == "Time1130")
			            args.colMerge(3);
			        else if (args.column.field == "Time330")
			            args.colMerge(2);
			        else if (args.column.field == "Time430")
			            args.colMerge(2);
			    }
			    else if (args.data.EmployeeID == 10004) {
			        if (args.column.field == "Time1100")
			            args.colMerge(4);
			        else if (args.column.field == "Time400")
			            args.colMerge(2);
			    }
			    else if (args.data.EmployeeID == 10005) {
			        if (args.column.field == "Time900")
			            args.colMerge(4);
			        else if (args.column.field == "Time1130")
			            args.colMerge(3);
			        else if (args.column.field == "Time330")
			            args.merge(2, 2);
			        else if (args.column.field == "Time430")
			            args.colMerge(2);
			    }
			    else if (args.data.EmployeeID == 10006) {
			        if (args.column.field == "Time900")
			            args.colMerge(2);
			        else if (args.column.field == "Time1000")
			            args.colMerge(3);
			        else if (args.column.field == "Time1130")
			            args.colMerge(3);
			        else if (args.column.field == "Time430")
			            args.colMerge(2);
			    }
			    else if (args.data.EmployeeID == 10007) {
			        if (args.column.field == "Time900")
			            args.colMerge(2);
			        else if (args.column.field == "Time1030")
			            args.colMerge(2);
			        else if (args.column.field == "Time1130")
			            args.colMerge(3);
			        else if (args.column.field == "Time300")
			            args.colMerge(2);
			        else if (args.column.field == "Time400")
			            args.colMerge(3);
			    }
			    else if (args.data.EmployeeID == 10008) {
			        if (args.column.field == "Time900")
			            args.colMerge(3);
			        else if (args.column.field == "Time1030")
			            args.colMerge(3);
			        else if (args.column.field == "Time230")
			            args.merge(3, 2);
			        else if (args.column.field == "Time400")
			            args.colMerge(2);
			    }
			    else if (args.data.EmployeeID == 10009) {
			        if (args.column.field == "Time900")
			            args.colMerge(3);
			        else if (args.column.field == "Time1130")
			            args.merge(3, 2);
			        else if (args.column.field == "Time430")
			            args.colMerge(2);
			    }
			    else if (args.data.EmployeeID == 10010) {
			        if (args.column.field == "Time900")
			            args.colMerge(3);
			        else if (args.column.field == "Time1030")
			            args.colMerge(2);
			        else if (args.column.field == "Time230")
			            args.colMerge(3);
			        else if (args.column.field == "Time400")
			            args.colMerge(3);
			    }
			}
		</script>

